<div class="relative overflow-x-auto h-full">
  <table
    class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 table-fixed"
  >
    <tbody>
      @for (row of rows(); track row.index) {
        <tr
          class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 border-gray-200"
          (click)="selectRow(row, $event)"
        >
          <td
            class="px-1 py-1 w-12 h-8 border border-black dark:border-gray-500"
          >
            {{ $index + index() + 1 }}
          </td>
          @for (cell of row.cells; track cell.position) {
            <td
              class="px-1 py-1 h-8 border border-black dark:border-gray-500"
              (dblclick)="startEditing(cell)"
              (click)="selectCell(cell, $event)"
              [class.bg-blue-200]="cell.selected"
            >
              @if (cell.editing) {
                <input
                  class="small"
                  type="text"
                  (keydown)="onCellInputKeyDown(cell, $event)"
                  [(ngModel)]="cellInput"
                  (blur)="onClickOutside(cell)"
                  appAutoFocus
                />
              } @else {
                <div class="truncate text-nowrap overflow-ellipsis">
                  {{ cell.value }}
                </div>
              }
            </td>
          }
        </tr>
      }
    </tbody>
  </table>
</div>
